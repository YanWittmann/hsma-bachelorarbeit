\chapter{Grundlagen}\label{ch:grundlagen}


\section{Schwächen und Schwachstellen}\label{sec:def-weakness-vulnerability}

\paragraph{Schwäche (Weakness)}

Der Begriff \enquote{Schwäche} in einer Software-Komponente bezeichnet einen intrinsischen Fehler, Defekt oder eine problematische Eigenschaft, die unter bestimmten Bedingungen in einer Software oder Hardware zu unerwünschtem Verhalten führen kann \autocite{Ross_Winstead_McEvilley_2022}.
Schwächen beschreibende grundlegende Fehlermuster, die unabhängig von spezifischen Implementierungen oder Angriffsszenarien existieren.

Das \acrfull{cwe}-Projekt\footnote{\url{https://cwe.mitre.org/about/index.html}}, unter der Leitung der MITRE Corporation, stellt einen großen Katalog solcher Software-Schwächen dar.
Als Community-getriebenes Projekt ordnet es Schwächen in einem hierarchischen System als \acrshort{cwe}-Einträge an, die verschiedene Abstraktionsebenen abdecken\ \autocite{wu2016cwe}.
Die Klassifikation reicht von abstrakteren Kategorien (\verb+CWE-20+: Improper Input Validation\footnote{\url{https://cwe.mitre.org/data/definitions/20.html}}) bis zu konkreteren Implementierungsfehlern (\verb+CWE-125+: Out-of-bounds Read\footnote{\url{https://cwe.mitre.org/data/definitions/125.html}}).

\paragraph{Schwachstelle (Vulnerability)}

Während Schwächen allgemeine Fehlermuster beschreiben, stellt eine Schwachstelle eine konkrete Ausprägung einer Schwäche in einem spezifischen System oder Produkt dar.
Sie beeinträchtigt die zentralen \acrshort{ciavuln}-Sicherheitsziele (Confidentiality (Vertraulichkeit), Integrity (Integrität) oder Availability (Verfügbarkeit)) und stellen eine Verletzung formeller oder impliziter Sicherheitsanforderungen dar.
Das \acrshort{cve}-Programm, betrieben durch die MITRE Corporation und unterstützt von US-Behörden wie der \acrfull{cisa}, bietet einen weltweit anerkannten Standard zur Identifikation und Beschreibung von öffentlich bekannten Schwachstellen.
Jede Schwachstelle erhält dabei eine eindeutige Kennung (z.B.\ \verb+CVE-2024-12345+) und wird in Kooperation mit autorisierten \acrfull{cna} mit einer Beschreibung der Schwachstelle, Referenzen zu betroffenen Produktversionen, der zugrundeliegende \acrshort{cwe}-Klassifikation sowie einer Bewertung des Schweregrads klassifiziert\ \autocite{Ross_Winstead_McEvilley_2022, CveGlossaryCommonVulnerabilitiesAndExposures12mai2025}.
Die \acrshort{cve} Schwachstellen-Informationen werden über eine \acrshort{api} von der \acrshort{nvd} öffentlich zur Verfügung gestellt\footnote{\url{https://nvd.nist.gov/developers/vulnerabilities}}.

Im Rahmen dieser Arbeit werden ausschließlich \acrshort{cve} als Schwachstellen betrachtet, andere ähnliche Standards werden als \nameref{par:security-advisories} behandelt.

\paragraph{Security Advisories}\label{par:security-advisories}

% OSV, CSAF, etc.
% ich mochte die tabelle aus “Table 2. Security vulnerability databases (VDBs).” (Bennouk et al., 2024, p. 865) A Comprehensive Review and Assessment of Cybersecurity Vulnerability Detection Methodologies


\section{Schachstelldatenbanken}\label{sec:security-vulnerability-databases}

% VDBs
% “3.3. Security Vulnerability Databases” (Bennouk et al., 2024, p. 864) A Comprehensive Review and Assessment of Cybersecurity Vulnerability Detection Methodologies
% auflisten von den unterschiedlichen lieferanten von schwachstellinfos und advisories


\section{Software-Inventare}\label{sec:def-inventories}

Eine \acrfull{sbom} ist ein strukturiertes Inventar aller Software-Komponenten, aus denen ein System oder Produkt besteht.
Sie enthält Informationen über die Namen, Versionen, Lizenzen, Schwachstellen und Abhängigkeiten der Softwarebestandteile, sowie Metadaten wie Copyright-Hinweise oder kryptographische Hashes.
Eine \acrshort{sbom} hat das Ziel, die Transparenz in der Software-Lieferkette mit Informationen über die Herkunft und Zusammensetzung einer Software zu unterstützen, um den Nächsten in der Lieferkette eine Risikobewertung zu ermöglichen oder die Einhaltung von Lizenzbestimmungen nachweisen zu können \autocite{Bi_Xia_Xing_Lu_Zhu_2023}.

Eine \acrshort{sbom} kann sowohl manuell als auch automatisiert durch die Identifikation und Dokumentation aller verwendeten Software-Komponenten erfolgen.
Manuelle Methoden sind jedoch vor allem bei wiederholten Durchläufen inkonsistent, fehleranfällig und in größeren Projekten kaum skalierbar.
Die Aktualisierung von \acrshortpl{sbom} ist nötig, wenn z.B.\ bei neuen Versionen sich die Zusammensetzung einer Software verändert.
Daher wird die Erzeugung von \acrshortpl{sbom} in der Regel projektweit durch Werkzeuge, die Quellcode, Projektdateien oder Container analysieren, durchgeführt \autocite{Bi_Xia_Xing_Lu_Zhu_2023}.

Die Qualität eines Software-Inventars ist für eine erfolgreiche Sicherheitsanalyse wichtig, da die Zuordnung bekannter Schwachstellen zu konkreten Software-Komponenten von der Genauigkeit und Vollständigkeit des Inventars abhängt.
Fehlende oder ungenaue Angaben zu Produktnamen und Versionen können durch die inhaltliche oder formale Abweichung von Produktrepräsentationen zwischen Inventaren und \acrshortpl{vdb} zu falsch-positiven oder falsch-negativen Schwachstellenzuweisungen führen \autocite{Idrissi_Sebai_Faroukhi_Mahouachi_2024}.

Zur einheitlichen Darstellung und Verbreitung solcher Inventare haben sich mehrere maschinenlesbare Standards etabliert.

\paragraph{\acrfull{spdx}}\footnote{\url{https://spdx.dev}}
wurde ursprünglich für das Lizenzmanagement entwickelt und stellt heute einen häufig eingesetzten Standard zur Beschreibung von Software-Inventaren dar.
Der Fokus des Projekts liegt noch immer auf der Darstellung lizenzrechtlicher Informationen, jedoch lassen sich mit \acrshort{spdx} auch Komponenten, Abhängigkeiten und Beziehungen detailliert beschreiben \autocite{spdxOverview1june2024}.
\acrshort{spdx} wird von der Linux Foundation gepflegt und ist unter \texttt{ISO/IEC 5962:2021}\footnote{\url{https://www.iso.org/standard/81870.html}} international standardisiert.

\paragraph{CycloneDX}\footnote{\url{https://cyclonedx.org}}
wurde von der OWASP Foundation in Zusammenarbeit mit Ecma International entwickelt und ist seit 2024 als Standard \texttt{ECMA-424} veröffentlicht \autocite{CycloneDX2024Spec, ecma424:2024}.
CycloneDX beschreibt ein maschinenlesbares Format zur Dokumentation von Software-Komponenten, deren direkten Abhängigkeiten, Lizenzinformationen, kryptografischen Prüfsummen und bekannten Schwachstellen.
Durch die Möglichkeit, eigene Felder und Erweiterungen in den Dokumenten zu verwenden, können domänenspezifische Anforderungen ohne Anpassung des Standards abgedeckt werden.
Neuere Versionen führen Erweiterungen für z.B.\ für Hardware-Komponenten (HBOM)\footnote{\url{https://cyclonedx.org/capabilities/hbom}}, KI-Modelle und Trainingsdaten (AI/ML-BOM)\footnote{\url{https://cyclonedx.org/capabilities/mlbom}} oder Konfigurationen und Betriebsdaten (OBOM)\footnote{\url{https://cyclonedx.org/capabilities/obom}} hinzu.

\paragraph{\metaeffekt-Inventare}
werden im Detail in \autoref{sec:metaeffekt-inventory-format} erklärt.
Durch Konverter-Plugins\footnote{\url{https://gitlab.opencode.de/metaeffekt/metaeffekt-components/-/tree/master}} können Inventare vom und zum proprietären Format der \metaeffektsp von \acrshort{spdx} und CycloneDX konvertiert werden.
Durch den \metaeffektsp Extractor kann die Erzeugung von Inventaren auf Basis von Analysen von Quellcode, Build-Artefakten oder Softwarecontainern automatisiert werden.
Die erzeugten Inventare im \metaeffekt-Format können dann in der Schwachstellenanalyse oder Lizenzklassifikation verwendet werden und dienen als Eingabe in die Prozesse, die in dieser Arbeit entwickelt werden sollen.

% “Table 3. SBOM issue categories” ([Bi et al., 2023, p. 13](zotero://select/library/items/WYCQM3PA)) ([pdf](zotero://open-pdf/library/items/XG7WITCJ?page=13&annotation=LSB777ZB)) Bi_Xia_Xing_Lu_Zhu_2023
%   ganz nette übersicht über die use-cases der SBOM


\section{\acrlongpl{vms}}\label{sec:grundlagen-vms}

Vulnerability Management (Schwachstellenmanagement) beschreibt den wiederkehrenden Prozess zur Erkennung von Sicherheitslücken in IT-Systemen.
Ziel ist es, Schwachstellen vor auslieferung des Systems zu identifizieren, nach Risiko zu bewerten und durch Patches oder Gegenmaßnahmen zu mitigieren.
Der typische Schwachstellenmanagement-Prozess besteht aus vier Hauptphasen: (1) Scanning, (2) Schwachstellenerkennung, (3) Analyse und (4) Reporting.
In der Praxis werden dabei zunächst Schwachstellen durch Abgleich mit bekannten \acrshortpl{vdb} identifiziert und mit Metadaten angereichert, um eine automatisierte Priorisierung und Reihenfolge des Vorgehens abzuleiten, bevor die manuelle Behebung durch Patches oder Workarounds erfolgt und schließlich die Wirksamkeit der Korrekturmaßnahmen überprüft wird \autocite{foreman2019vulnerabilityManagement}.

Schwachstellmanagement als Prozess verwendet somit die priorisierte Liste an Schwachstellen eines Schwachstellenscans, um dann durch manuelle Bewertungsprozesse bis zu einem durch Rahmenbedingungen gesetzen Score-Limit die Schwachstellen auszuwerten und zu bewerten \autocite{foreman2019vulnerabilityManagement}.

Die Identifikation von Schwachstellen ist also nur der erste Schritt in einem vollständigen Schachstellmanagement.
Diesen manuell regelmäßig durchzuführen ist zeitaufwendig, ein \acrshort{vms} automatisiert darum durch den Abgleich mit \acrshortpl{vdb} (wie \acrshort{cve} mit \acrshort{cpe} der \acrshort{nvd}) zur Identifikation von Schwachstellen und der Priorisierung bereits wesentliche aufwendige Schritte des Schwachstellenmanagements \autocite{Idrissi_Sebai_Faroukhi_Mahouachi_2024}.

Die Effektivität eines \acrshort{vms} hängt dabei stark von der Qualität der zugrundeliegenden Software-Inventare und Produktidentifikationsmechanismen ab (vgl. \autoref{sec:def-inventories}).
Einige Mechanismen für die Erkennung von Produkten werden in \autoref{sec:produktidentifikationsstandards-herausforderungen} vorgestellt und es wird festgestellt, dass diese für die genaue Erkennung zu Fehleranfällig sind und es meist einem manuellen Korrekturschritt bedarf.


\section{Produktidentifikationsstandards, Formate und ihre Herausforderungen}\label{sec:produktidentifikationsstandards-herausforderungen}

\subsection{Produkte und ihre Repräsentation}

% erst mal allgemein darüber reden worum es geht
% Name ≠ Identity
% Intrinsic vs extrinsic naming scheme
% warum gibt es so viele formate (jeder sein use-case)

Die genaue Identifikation von Softwareprodukten stellt eine grundlegende Voraussetzung für ein Schwachstellenmanagement wie in \autoref{sec:grundlagen-vms} beschrieben dar.
Um bekannte Schwachstellen aus \acrshortpl{vdb} korrekt mit Software-Inventaren abgleichen zu können, müssen Produktidentifikatoren so beschaffen sein, dass eine unmissverständliche Zuordnung dieser Software von anderen Parteien oder mit Informationen wie bekannten Schwachstellen möglich ist.
% Um Schwachstellmanagement wie in \autoref{sec:grundlagen-vms} beschrieben effektiv durchführen zu können, muss Software in Software-Inventaren auf eine Weise angegeben sein, die eine Korrelation dieser Software mit anderen Informationen wie bekannten Schwachstellen erlaubt.
% Das Ziel muss es sein, dass verschiedene Akteure wie Konsumenten von \acrshortpl{vdb}, Inventarwerkzeuge und Sicherheitsexperten mit der Darstellung der Software genau wissen, dass sie über dieselbe Software reden.
In der Praxis ist dieses Ziel jedoch aufgrund der vielen heterogenen Lösungen zur Software-Identifikation kaum zu erreichen.
Sie haben jeweils eine unterschiedliche Granularität oder einen anderen Fokus und lassen sich darum nicht einfach gegenseitig ineinander überführen \autocite{CISA2023}.

Ein grundlegendes Problem bei der Identifikation ist die Unterscheidung zwischen einem \textit{Namen} und einer eindeutigen \textit{Identität} \autocite{Manion_Proell_Schmidt2023}.
Anhand eines Beispiels aus der Chemie:
Natriumchlorid ist eine kubische Kristallstruktur und kann mit \textit{NaCl} als identifizierende Verhältnisformel vollständig nur aufgrund seiner inherenten Eigenschaften beschrieben werden.
Allerdings gibt es noch weitere Systeme, wie chemische Stoffe angegeben werden können.
Authoritative Systeme wie CAS-Nummern definieren einen autoritativen, künstlichen Bezeichner für Stoffe, so etwa \textit{7647-14-5} für Natriumchlorid \autocite{Huebner_2003}.
Die \textit{Identität} ist die eigentliche Zusammensetzung von Natriumchlorid, NaCl und 7647-14-5 sind Namen, die dieser Struktur gegeben wurden.

Ebenso verhält es sich mit Software.
Ein zu benennendes Artefakt kann sich auf eine oder mehrere Dateien beziehen, aber auch auf ein Betriebssystem, Hardware, eine Sammlung an Projekten und weiteren, beliebigen Inhalten.
Die Bezüge der Hersteller zu den Artefakten können jederzeit ändern:
Neue Hersteller treten in den Markt, ziehen sich zurück, werden aufgekauft oder zusammengeführt, aber auch alleine die Projekte können geforkt, archiviert oder aufgegeben werden.
Projekte und Produkte können in komplexen Beziehungen stehen und transformieren sich stets weiter.
Diese Gefüge lassen sich nicht mit den bisherigen häufig eingesetzen Identifikationsstandards abbilden \autocite{Manion_Proell_Schmidt2023}.

In dieser Arbeit wird der Begriff \textit{Produkt} für abgrenzbare Software- oder Hardware-Artefakte (z.B. \texttt{Log4J-API}) verwendet; der Begriff \textit{Repräsentation} bezeichnet eine standardisierte Darstellung desselben Produkts (wie \texttt{cpe:/a:apache:log4j}, \texttt{pkg:maven/org.apache.logging.log4j/log4j-api} oder \texttt{log4j-api-2.23.0.jar}).
Während sich ein Produkt auf konzeptioneller Ebene bewegt und exakt von anderen Produkten abgrenzen lässt, können Repräsentationen eine unterschiedlich scharfe Blase aufspannen und sich mehr oder weniger spezifisch auf ein oder mehrere tatsächliche Produkte beziehen.
So steht \texttt{cpe:/a:apache:log4j} nicht nur für die \texttt{Log4J-API}, sondern für das gesamte Log4j-Projekt inklusive aller seiner Module, während sich \texttt{pkg:maven/org.apache.logging.log4j/log4j-api} konkret auf das Java-Artefakt auf Maven Central\footnote{\url{https://repo1.maven.org/maven2/org/apache/logging/log4j/log4j-api/2.23.0}} bezieht.

Der Begriff \enquote{Produktidentifikationsstandard-\textit{Ökosystem}} wird wie von \citeauthor{CISA2023} dazu verwendet, um zu verdeutlichen, dass es nicht einfach ausreicht, ein technisches Format zur Beschreibung von Softwareprodukten zu definieren.
Vielmehr ist ein Ökosystem welches von der Industrie akzeptiert und deren Regeln durchgängig angewendet werden notwendig, das auch Prozesse zur Erstellung, Verbreitung und Nutzung solcher Identifikatoren umfasst \autocite{CISA2023}.
Produktidentifikatoren müssen in allen relevanten Kontexten und Zeitpunkten verfügbar sein, sei es durch die Weitergabe dieser Identifikatoren durch Hersteller und Zwischenherstellern, oder indem sich die Identifikatoren aus der Software selbst herleiten lassen.
Zudem muss das Ökosystem alle Nutzungskontexte und Granularitätsstufen unterstützen die in der Realität auftreten können, Softwarevarianten bis zu allgemeinen Produktfamilien.

Im Folgenden werden Produktidentifikationsstandards in zwei Kategorien differenziert, in den Abschnitten danach wird diese Unterscheidung als Grundlage für die Bewertung existierender Ansätze verwendet.

\paragraph{Inherente Identifikatoren} % inherente, eigenschaftsbasierte, intrinsische
oder auch eigenschaftsbasierter Identifikatoren lassen sich direkt deterministisch aus einem Software-Artefakt selbst ableiten, ohne weitere namensgebende Register oder zentrale Organisationen zu benötigen.
\citeauthor{CISA2023} sieht als das Kriterium für diese Art, dass sich die Identifikatoren ausschließlich aufgrund von den Dateien der Software berechnet werden kann.
Kryptografische Hashwerte wie etwa SHA1 oder SHA256 mit Standards wie OmniBOR\footnote{\url{https://omnibor.io}} sind die bekannteste Form von inhärenten Identifikatoren.

In der Praxis bestehen jedoch mehrere Herausforderungen:
\begin{itemize}
    \item in Softwareprojekten ist oft unklar, auf welche Datei oder welche Menge sich eine Hashfunktion ausgeführt werden muss, um den relevanten Hash zu erhalten.

    \item Builds können durch Metainformationen, Timestamps oder Umgebungsfaktoren voneinander abweichen, obwohl funktional dieselbe identische Software verwendet wird \autocite{CISA2023}.

    \item Die aktuell bei der \metaeffektsp eingesetzten \acrshortpl{vdb} (wie die \acrshort{nvd}) verwenden keine Datei-Hashes zur Produktidentifikation, damit bringen Hashes effektiv keinen Mehrwert.
\end{itemize}

In dieser Arbeit wird zusätzlich auch \acrshort{purl} als inherente Identifikator gesehen, da ein großer Teil der Software-Artefakte in den Inventaren der \metaeffektsp sich eindeutig \acrshortpl{purl} zuweisen lassen.

\paragraph{Autoritative Identifikatoren}\label{par:authorative-identifiers} % definierte, extrinsische
werden durch eine bestimmte Partei explizit einem Softwareprodukt zugewiesen und sind damit eine von außen vergebene Referenz auf ein Produkt.
Anders als bei inhärenten Identifikatoren gibt es bei autoritativen Identifikatoren nicht die Möglichkeit, diese ohne das Wissen einer äußeren Quelle zu erfahren.
Es muss also entweder selbst einen solchen Identifikator erzeugt und in einem Register, registriert werden oder auf einen im Register vorhandenen zurückgegriffen werden.
Parteien, die für das Erzeugen, Registrieren und Verwalten von Identifikatoren verantwortlich sind, werden \enquote{Identifier-Generatoren} genannt \autocite{CISA2023}.
Generatoren können sich auf manuelle oder automatische Prozesse beziehen.

Damit ein Identifier im Ökosystem effektiv verwendet werden kann, muss er zunächst erzeugt werden, denn eine Software besitzt keinen autoritativen Identifikator solange nicht eine entsprechende Partei diese Bindung festlegt und verbreitet.
Die Herausforderung liegt also nicht in der jeweiligen Syntax der Standards, sondern in der Organisation, Existenz und Genauigkeit der Verbindungen zwischen Identifikator und Software.
Dies geschieht typischerweise durch zentrale Datenbanken (wie bei \acrshort{cpe}) oder durch Mitführung in der Software selbst (wie bei \acrfull{swid}) \autocite{CISA2023}.

Autoritative Identifikatoren stellen einige weitere Herausforderungen dar:

\begin{itemize}
    \item Die Wiederverwendung von autoritativen Identifikatoren durch verschiedene Generatoren, die denselben Bezeichner fälschlicherweise für unterschiedliche Software vergeben, entstehen Falsch-Positive Schwachstell-Identifikationen in späteren Phasen des \acrshort{vms} \autocite{CISA2023}.
    Dies kann leicht durch identische Namen einer Software beim Abgleich von Datenbanken mit den Identifikatoren passieren, oder durch falsche Erwartungen auf Seiten beider Generatoren.
    Betrachtet man beispielsweise die Software \texttt{proton-j-0.27.3.jar}, so könnte bei einem ersten Blick der \acrshort{cpe}-Identifikator \texttt{cpe:/a:proton\_project:proton} vom Namen her passend erscheinen.
    Bei genauerer Betrachtung bezieht sich dieser Identifikator allerdings auf eine Web-Applikation und kein Java-Projekt.
    Erst nach einer weiteren Analyse von potenziellen Identifikatoren stellt sich heraus, dass \texttt{cpe:/a:apache:qpid\_proton-j} die richtige Wahl für die das Apache-Projekt ist.

    \item Wenn für dieselbe Software mehrfach ein neuer Identifier vergeben wird (Überidentifikation), entstehen Falsch-Negative Lücken in der Schwachstell-Identifikation, da die doppelten Datenpunkte nicht eindeutig zusammengeführt werden können \autocite{CISA2023}.
    Ein Beispiel sind die \acrshort{cpe} für Cyrus SASL\footnote{\url{https://github.com/cyrusimap/cyrus-sasl}}, die ihre Haupt-\acrshort{cpe} \texttt{cpe:/a:cyrusimap:cyrus-sasl} besitzen, jedoch daneben auch noch eine Reihe an weiteren von anderen Generatoren registriert wurden, die dasselbe Produkt meinen:
    \texttt{cpe:/a:carnegie\_mellon\_university:cyrus-sasl, cpe:/a:cmu:cyrus-sasl, cpe:/a:cyrusimap:cyrus\_sasl, cpe:/a:cyrus:sasl} wurden von Forschern an der \acrfull{cmu} einmal mit ihren ausgeschriebenen Namen und einmal mit ihrem Kürzel vergeben um sich als Entdecker einer Schwachstelle in diesem Produkt zu verewigen, aber auch Doppelregistrierungen mit kleinen Unterschieden wie dem Ersetzen eines Bindestrichs mit einem Underscore sind häufig zu finden.

    \item Fehlerhaft registrierte Identifikatoren (Rechtschreibfehler, nicht existierende Produkte, \ldots) könne nicht einfach aus den Daten entfernt oder korrigiert werden, da andere Systeme diese bereits konsumiert haben könnten und durch den Weitertransport an Dritte muss die Erwartung der Existenz dieser aufrechterhalten werden.
    Ein Beispiel sind die \acrshort{cpe} für Python, bei diesen wurde bei der Erstellung zunächst eine falsch benannte \texttt{cpe:2.3:a:python:py\textit{ht}on} registriert und kurz darauf mit der \texttt{cpe:2.3:a:python:python} korrigiert.
    Die Existenz der falschen \acrshort{cpe} wird für immer in dem Datensatz vorhanden sein.

    \item Die Verbreitung der Identifikatoren ist ein weiteres Hindernis, eine zentrale Datenbank wäre Ideal, falls jedoch ein wahrlich allumfassendes Register an Software dieser Welt erstellt werden soll, wird die Pflege auf globaler Ebene herausfordernd.
    Die Koordination von Identifier-Generatoren ist wie in den anderen Punkten erwähnt realistisch kaum umsetzbar, und von jedem Generator zu fordern, eine eigene Infrastruktur für etwas aufzubauen, was für die meisten nur ein Hintergedanke ist, ist ebenfalls nicht möglich \autocite{CISA2023}.
\end{itemize}

Diese Herausforderungen sind Teil der Begründung, warum heutzutage eine solche Vielfalt an Standards nebeneinander ko-existieren und die jeweils nur einen kleineren Aspekt oder eine Untermenge der Menge an Produkten adressieren.
Für ein funktionierendes Ökosystem autoritativer Identifikatoren sind neben dem Format also vor allem die umliegenden Prozesse zur Erzeugung, zur Veröffentlichung und zur Verteilung der Identifikatoren im gesamten Lebenszyklus von Software entscheidend.

\subsection{\acrfull{cpe}}

% Sanguino_Uetz_2017
% “2.1. Common Platform Enumeration (CPE) CPE is a method that specifies a naming scheme for applications, hardware devices, and operating systems. CPE is part of the Security Content Automation Protocol (SCAP)5 standard, which was proposed by the National Institute of Standards and Technology (NIST). Currently, there exist two versions of the CPE specification: CPE 2.2 and CPE 2.3. Version 2.3 defines a stack formed by five specifications, including the CPE naming specification [4] and the CPE dictionary specification [5].” (Sanguino and Uetz, 2017, p. 3)
% “3. CPE Dictionary and CVE Feeds Analysis” “This section discusses issues that we found in the official CPE dictionary9 and CVE feeds10” (Sanguino and Uetz, 2017, p. 6)
% the above paper also talks quite well about CVE \autocite{Sanguino_Uetz_2017}

\acrshort{cpe} ist ein im Rahmen des \acrfull{scap}\footnote{\url{https://scap.nist.gov}}-Standard durch das \acrshort{nist} veröffentlichter autoritativer Produktidentifikationsstandard zur einheitlichen Benennung von Applikationen, Betriebssystemen und Hardware.
Die beiden aktuell gültigen Versionen der Spezifikationen sind \acrshort{cpe} 2.2 und \acrshort{cpe} 2.3.
Version 2.3 wird durch fünf getrennte Spezifikationen definiert, die jeweils einen Aspekt in den Fokus nehmen, von denen die \acrshort{cpe} Naming Specification \autocite{Cheikes_Waltermire_Scarfone_2011} und \acrshort{cpe} Matching Specification \autocite{Parmelee_Booth_Waltermire_Scarfone_2011} die relevantesten sind.
Die Version 2.3 ist durch fünf Spezifikationen definiert, wobei besonders die Naming Specification \autocite{Cheikes_Waltermire_Scarfone_2011} und die Matching Specification \autocite{Parmelee_Booth_Waltermire_Scarfone_2011} in diesem Kontext relevant sind.

Die \acrshort{cpe} 2.3 Naming Specification definiert eine strukturierte Menge an Attribut-Wert-Paaren, sogenannte \textit{\acrfull{wfn}}.
Die \acrshort{wfn} umfassen diese Attribute: \texttt{part, vendor, product, version, update, edition, language, sw edition, target sw, target hw, other}.
Die Schreibweise dieser \acrshort{wfn} unterscheidet sich je nach Spezifikationsversion:
Über einen Prozess namens \enquote{string binding} werden die \acrshort{wfn}-Attribute je nach Spezifikationsversion für 2.2 in \enquote{URI-Strings} (Beispiele in \autoref{lst:initial-cpe-examples-format-string}) oder für 2.3 in \enquote{Formatted Strings} (Beispiele in \autoref{lst:initial-cpe-examples-uri}) als textuelle Schreibweise dargestellt \autocite{Cheikes_Waltermire_Scarfone_2011}.
In dieser Arbeit werden die beiden Versionen des Standards aufgrund des großen Überlappens der Attribut-Mengen neben der unterschiedlichen string bindings in der zugrundeliegenden Semantik der verwendeten Attribute als identisch behandelt.

\begin{lstlisting}[caption=Beispielhafte WFN als CPE 2.3 Format Strings,label=lst:initial-cpe-examples-format-string]
cpe:2.3:a:apache:tomcat:7.0.48:*:*:*:*:*:*:*
cpe:2.3:a:log4js_project:log4js:5.2.0:*:*:*:*:node.js:*:*
cpe:2.3:o:linux:linux_kernel:5.1.21:*:*:*:*:*:*:*
cpe:2.3:h:hp:s1000-e_vpn_firewall_appliance:jd272a:*:*:*:*:*:*:*
\end{lstlisting}

\begin{lstlisting}[caption=Beispielhafte WFN als CPE 2.2 URI,label=lst:initial-cpe-examples-uri]
cpe:/a:apache:tomcat:7.0.48
cpe:/a:log4js_project:log4js:5.2.0::~~~node.js~~
cpe:/o:linux:linux_kernel:5.1.21
cpe:/h:hp:s1000-e_vpn_firewall_appliance:jd272a
\end{lstlisting}

Für die Identifikation eines Produkts sind vor allem die Attribute \texttt{part}, \texttt{vendor} und \texttt{product} wichtig, ergänzt durch \texttt{version} und \texttt{update} für Versionsangaben \autocite{Cheikes_Waltermire_Scarfone_2011}.
Eine Auswertung des offiziellen \acrshort{nvd} \acrshort{cpe} Dictionary\footnote{\url{https://nvd.nist.gov/products/cpe}} zeigt, dass zusätzliche Attributfelder neben dieser Hauptidentifikatoren nur in etwa 26\,\% der Einträge verwendet werden, die genaue Verteilung dieser optionalen Attribute ist in \autoref{tab:cpe-attribute-verteilung} dargestellt.
Die erweiterten Attributfelder sind also zwar technisch vorgesehen, werden aber in der Praxis nur begrenzt verwendet.

% OrderedDict([('target_sw', 23.37), ('sw_edition', 3.72), ('edition', 0.72), ('target_hw', 0.43), ('language', 0.04), ('other', 0.01)])
\begin{table}[h]
    \centering
    \begin{tabular}{lr}
        \toprule
        \textbf{Attribut}   & \textbf{Anteil an allen CPEs} \\
        \midrule
        \texttt{target sw}  & 23{,}37\,\%                   \\
        \texttt{sw edition} & 3{,}72\,\%                    \\
        \texttt{edition}    & 0{,}72\,\%                    \\
        \texttt{target hw}  & 0{,}43\,\%                    \\
        \texttt{language}   & 0{,}04\,\%                    \\
        \texttt{other}      & 0{,}01\,\%                    \\
        \bottomrule
    \end{tabular}
    \caption{Verwendung erweiterter CPE-Attribute im NVD Dictionary}
    \label{tab:cpe-attribute-verteilung}
\end{table}

Neben dem ersten Attribut \texttt{part}, welches nur einen der drei Werte \texttt{a} für \enquote{Application}, \texttt{h} für \enquote{Hardware} und \texttt{o} für \enquote{Operating System} annehmen kann, können alle weiteren Attribute beliebige Texte enthalten.
Alternativ kann jedes Attribut auch auf einen von zwei Werten mit logischer Bedeutung gesetzt werden:
\enquote{\texttt{ANY}} (\enquote{\texttt{*}}) gibt an, dass bei einem Abgleich mit diesem Attribut jeder beliebige Wert gültig wäre und \enquote{\texttt{NA}} (\enquote{\texttt{-}}), bei dem explizit kein Wert in der zu vergleichenden \acrshort{cpe} stehen darf, um erfolgreich gematched zu werden \autocite{Parmelee_Booth_Waltermire_Scarfone_2011}.

Da \acrshort{cpe} das für die \metaeffektsp wichtigste Ökosystem zur Schwachstellenerkennung ist, werden in den folgenden Paragrafen noch einmal auf einige weitere Eigenschaften und Probleme eingegangen.

\paragraph{Probleme mit CPE}

Neben den allgemeinen Herausforderungen von autoritativen Identifikatoren (\autoref{par:authorative-identifiers}), gibt es noch einige weitere das \acrshort{cpe}-Ökosystem einen Bezug mit dem \acrshort{cve}-System haben.

\begin{itemize}
    \item So ist unter anderem die unvollständige Abdeckung von \acrshortpl{cve} durch \acrshortpl{cpe} ein Problem:
    Eine Analyse ergab, dass von den 291.389 \acrshort{cve}-Einträgen (Stand der Analyse, 09.06.2025) mit 40.652 fast 14\% keine einzige zugehörige \acrshort{cpe}-Konfiguration enthielten.
    Das führt dazu, dass diese Schwachstellen in automatisierten Systemen von Grund auf nicht erkannt werden können, obwohl sie dokumentiert sind \autocite{Sanguino_Uetz_2017}.
    Der Großteil dieser \acrshortpl{cve} sind Schwachstellen, die von der \acrshort{nvd} bislang laut eigener Aussage nicht vollständig dokumentiert wurden, weil sie mit dem exponentiellen Wachstum der Meldungen nicht mehr Schritt halten können\footnote{\url{https://www.nist.gov/itl/nvd}}.

    \item Die \acrshort{nvd} teilt ihren \acrshort{cpe}-Datensatz in zwei Teile auf, das \acrshort{cpe}-Dictionary \autocite{Cichonski_Waltermire_Scarfone_2011} und den \acrshort{cpe} Match Feed.
    Das bedeutet, dass Softwareprodukte existieren können, für die keine \acrshort{cpe}-Einträge im offiziellen Dictionary zugewiesen wurden aber im Match Feed verwendet werden, was bedeutet, dass ohne beide Datenquellen in Betracht zu ziehen und diese zu deduplizieren die relevanten Produkte nicht eindeutig mit Schwachstellen in Verbindung gebracht werden können \autocite{Sanguino_Uetz_2017}.
    \textcite{Sanguino_Uetz_2017} führen dieses Problem in weiterem Detail auf.

    % 2001004 total entries
    % 81821   deprecated entries
    % 3626    deprecated entries (unique)
    \item Die \acrshort{cpe}-Spezifikation definiert, dass eine \acrshort{cpe} durch Attributänderungen wie etwa Namenskorrekturen, das Ergänzen von neuen Informationen oder als Markierung für die Entfernung der \acrshort{cpe} als deprecated (veraltet) markiert werden kann \autocite{Cichonski_Waltermire_Scarfone_2011}.
    Laut \textcite{Sanguino_Uetz_2017} waren bis zum 14.02.2017 insgesamt 2614 eindeutige \acrshort{cpe}-Einträge als deprecated markiert, nach einer eigenen neuen Analyse am 09.06.2025 sind es 3626.
    Das Problem hierbei liegt wieder in der Schwachstellenanalyse:
    Wird in der Datenbank eine fehlerhafte \acrshort{cpe} durch eine korrigierte ersetzt, so werden nur in seltenen Fällen auch die \acrshort{cve} mit den neuen Identifikatoren aktualisiert, die diese \acrshort{cpe} verwenden.
    Das heißt, dass ein automatisiertes \acrshort{vms} selbst testen muss, ob eine zu prüfende \acrshort{cpe} selbst deprecated ist, oder andere deprecated, um diese weiteren \acrshortpl{cpe} als Aliase zur Suche verwenden zu können \autocite{Sanguino_Uetz_2017}.
    Ein Beispiel ist die \texttt{cpe:/a:adobe:flash\_playe\_for\_linux:9.0.115.0}, die keine \acrshortpl{cve} referenziert, sondern nur die korrigierten \texttt{cpe:/a:adobe:flash\_playe\textit{r}\_for\_linux:9.0.115.0} verknüpft ist.

    \item Zudem werden selten auch \acrshort{cpe} registriert, die nicht der Nomenklatur der \acrshort{cpe}-Spezifikation folgen.
    Diese ungültigen \acrshortpl{cpe} führen im besten Fall nur dazu, dass sie die zugeordneten Schwachstellen unauffindbar machen \autocite{Takahashi_Miyamoto_Nakao_2016}, im schlimmsten, dass das \acrshort{vms} nicht mit den Identifikatoren zurechtkommt und den Prozess der Schwachstellensuche aufgrund eines Fehlers abbricht.
    Einige Beispiele vergangener fehlerhafter \acrshortpl{cpe} werden mit ihren korrigierten Gegenstücken in \autoref{lst:invalid-cpe-strings-in-dictionary} aufgeführt.
\end{itemize}

\begin{lstlisting}[caption=Ungültige CPE 2.3 Format Strings aus dem NVD CPE Dictionary und ihre korrigierten Gegenstücke,label=lst:invalid-cpe-strings-in-dictionary]
Fehlendes "part"-Attribut:
   cpe:2.3:sainwp:onestore_sites:*:*:*:*:*:*:wordpress:*:*
   cpe:2.3:a:sainwp:onestore_sites:*:*:*:*:*:wordpress:*:*
"part" und "vendor"-Attribut sind nicht duch ein ":" getrennt:
   cpe:2.3:aainwp:onestore_sites:*:*:*:*:*:*:wordpress:*:*
   cpe:2.3:a:sainwp:onestore_sites:*:*:*:*:*:wordpress:*:*
Zu viele Attribute:
   cpe:2.3:a:sainwp:onestore_sites:*:*:*:*:*:*:wordpress:*:*
   cpe:2.3:a:sainwp:onestore_sites:*:*:*:*:*:wordpress:*:*
"cpe:2.3:*" wird doppelt wiederholt:
   cpe:2.3:*:cpe:2.3:*:ninjateam:gdpr_ccpa_compliance_&_cookie_consent_banner:2.7.2:*:*:*:*:wordpress:*:*
   cpe:2.3:a:ninjateam:gdpr_ccpa_compliance_&_cookie_consent_banner:2.7.2:*:*:*:*:wordpress:*:*
\end{lstlisting}

% % einige davon sind bereits in dem Kaptiel weiter oben aufgeführt und darum wiederhole ich sie nicht noch einmal
% Probleme mit CPE:
% “3.1. CVE entries without CPE entries” (Sanguino and Uetz, 2017, p. 7) Sanguino_Uetz_2017
%       Found [40652 / 291389] vulnerabilities that do not have any vulnerable software configurations
% “3.2. Software Products without assigned CPE” (Sanguino and Uetz, 2017, p. 7)
% “3.3. CPE Dictionary Deprecation Process” (Sanguino and Uetz, 2017, p. 8)
% “When CVE matches for a software product are found, IVA does not automatically generate alerts. The user must confirm that a CVE is indeed a vulnerability for the software product.” (Sanguino and Uetz, 2017, p. 23)
%       notwendigkeit dass man manuell daran arbeiten muss
% man kann sie nicht einfach erraten, weil sie nicht einer konvention folgen:
%       “However, some CPE-IDs registered in the dictionary may not follow the nomenclature rules of CPE specification. For instance, Hidemaru’s CPE-ID violated the rules at the time of this writing.” (Takahashi et al., 2016, p. 4) Takahashi_Miyamoto_Nakao_2016
% python pthyon

\paragraph{Identifikation von CPE}\label{par:automated-cpe-identification}

% “Table 3. Collected methods related to the similarity matching-based approach.” (Bennouk et al., 2024, p. 870) A Comprehensive Review and Assessment of Cybersecurity Vulnerability Detection Methodologies
% “In the first step, CPE identifiers that could be assigned to a software product (CPE candidates) are searched for.” (Sanguino and Uetz, 2017, p. 10) Sanguino_Uetz_2017
%    “5.2.1. CPE Matching As can be seen in Table 3, IVA would be able to automatically assign the correct CPEs to ten products; however, to the products P6 and P11 incorrect CPEs would be assigned.” (Sanguino and Uetz, 2017, p. 19) Sanguino_Uetz_2017
% “Because we typically find only a few exact matches, we use a numerical method to determine a CPE-ID. We introduce a parameter, called matching rate, which is calculated as the percentage of the characters that match the query.” (Takahashi et al., 2016, p. 3) Takahashi_Miyamoto_Nakao_2016
%    “We choose the CPE-ID that shows the highest matching rate, although we judge that no CPE-ID is found if we do not find a CPE-ID with matching rate higher than a certain threshold value.” (Takahashi et al., 2016, p. 3) Takahashi_Miyamoto_Nakao_2016
% “The novelty of this research consists in the algorithm for mapping software names in the information system to the CPE entries based on the Ratcliff/Obershelp algorithm recursively implemented for the software product name’s parts.” (Ushakov et al., 2021, p. 353) Ushakov_Doynikova_Novikova_Kotenko_2021
%    “Research work Method CPE fields Disadvantages Gawron et al., 2017 [6] Regular expression. Name and version Not unified entries or entries with errors are not mapped Sanguino and Uetz [7, 8] Levenshtein algorithm to select CPE candidates based on vendor and name, distance should be less than 2. Versions are used to prioritize the candidates. Vendor, name, and version Requires manual selection from several CPE candidates to avoid errors. Evaluation on 12 products. O'Hare and Macfarlane, 2018 [9] Levenshtein algorithm applied to the CPE list. Candidates with the minimum distance are selected (consequently, 0, 1, or 2). Full entry Error-prone. Na et al., 2017 [10] Hierarchical tree based on entry fields, full words comparison Full entry Error-prone, no evaluation. Bela and Enachescu, 2015 [11] Multiple hierarchical trees Full entry Error-prone” (Ushakov et al., 2021, p. 354) Ushakov_Doynikova_Novikova_Kotenko_2021
%    basically eine zusammenfassung von untersch. papers zum thema

\subsection{PURL}



\subsection{MSRC Product-Ids}\label{subsec:msrc-product-ids}

% https://github.com/org-metaeffekt/metaeffekt-documentation/blob/bd184b2889d5421b5a71dcd26c1ac0ffc63d07e7/metaeffekt-vulnerability-management/data-mirror/eol/eol-data-specific-cycles.md

\subsection{EOL Product-Ids}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% somewhere else
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% “Rule #1 Partition by supplier” (Manion et al., p. 18)
% \citeauthor{Manion_Proell_Schmidt2023} erkennen, dass diese Gefüge sich nicht mit den bisherigen häufig eingesetzen Identifikationsstandards abbilden lassen können.
% Sie schlagen vor,
